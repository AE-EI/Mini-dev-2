<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Cr√©ateur de Devis</title>
<style>
  body { font-family: Arial, sans-serif; margin: 20px; background: #f5f5f5; }
  h2 { margin-bottom: 10px; }
  .btn { display: inline-block; margin: 5px; padding: 10px 15px; background: #333; color: white; text-decoration: none; border-radius: 5px; cursor: pointer; }
  .btn:hover { background: #555; }
  .back-btn { background: #999; }
  .hidden { display: none; }
  textarea { width: 100%; height: 80px; }
</style>
</head>
<body>

<script>
/* 
=============================
üí° COMMENT CHANGER LES PRIX
=============================
- Tous les prix sont d√©finis dans l'objet `tarifs` ci-dessous.
- Exemple : tarifs["Prise"].creation = 150; // change prix cr√©ation prise
- Les cl√©s : creation, recablage_sans, recablage_avec, remplacement
*/

const tarifs = {
  "Prise": { creation: 120, recablage_sans: 50, recablage_avec: 70, remplacement: 20 },
  "Point de centre": { creation: 100, recablage_sans: 50, recablage_avec: 75, remplacement: 30 },
  "Applique": { creation: 100, recablage_sans: 50, recablage_avec: 75, remplacement: 30 },
  "Interrupteur simple": { creation: 40, recablage_sans: 50, recablage_avec: 75, remplacement: 25 },
  "Interrupteur double": { creation: 60, recablage_sans: 50, recablage_avec: 85, remplacement: 35 }
};

let devis = {};
let currentPiece = "";
let currentCategory = "";
let currentIntervention = "";
let currentPose = "";
let currentDesignation = "";

// Navigation helpers
function showPage(id) {
  document.querySelectorAll(".page").forEach(p => p.classList.add("hidden"));
  document.getElementById(id).classList.remove("hidden");
}

// Ajouter une pi√®ce
function selectPiece(piece) {
  currentPiece = piece;
  if (!devis[piece]) devis[piece] = { items: [], note: "" };
  showPage("categoryPage");
}

// S√©lection cat√©gorie (Prises ou √âclairage)
function selectCategory(cat) {
  currentCategory = cat;
  showPage("interventionPage");
}

// Type d‚Äôintervention
function selectIntervention(type) {
  currentIntervention = type;
  if (type === "Cr√©ation") {
    showPage("posePage");
  } else if (type.startsWith("Rec√¢blage")) {
    showPage("designationPage");
  } else if (type.startsWith("Remplacement")) {
    showPage("designationPage");
  }
}

// Type de pose
function selectPose(pose) {
  currentPose = pose;
  showPage("designationPage");
}

// D√©signation
function selectDesignation(designation) {
  currentDesignation = designation;
  showPage("quantityPage");
}

// Ajouter l‚Äô√©l√©ment
function addItem(qty) {
  let prix = 0;
  let catPrix = tarifs[currentDesignation] || tarifs[currentCategory];
  if (currentIntervention === "Cr√©ation") {
    prix = catPrix.creation;
  } else if (currentIntervention === "Rec√¢blage sans remplacement d‚Äôun appareillage") {
    prix = catPrix.recablage_sans;
  } else if (currentIntervention === "Rec√¢blage avec remplacement d‚Äôun appareillage" || currentIntervention.includes("luminaire")) {
    prix = catPrix.recablage_avec;
  } else if (currentIntervention.startsWith("Remplacement")) {
    prix = catPrix.remplacement;
  }

  devis[currentPiece].items.push({
    intervention: currentIntervention,
    pose: currentPose,
    designation: currentDesignation,
    prix: prix,
    qty: qty
  });

  resetFlow();
  showPage("homePage");
}

// Ajouter une note
function addNote() {
  devis[currentPiece].note = document.getElementById("noteInput").value;
  showPage("homePage");
}

// Reset variables
function resetFlow() {
  currentCategory = "";
  currentIntervention = "";
  currentPose = "";
  currentDesignation = "";
}

// Voir le r√©sum√©
function viewSummary() {
  let output = "";
  for (let piece in devis) {
    output += `<b>${piece}</b><br>`;
    devis[piece].items.forEach(item => {
      let poseTxt = item.pose ? ` ${item.pose}` : "";
      output += `- ${item.intervention} : ${item.qty} ${item.designation}${poseTxt} (${item.prix}‚Ç¨/u)<br>`;
    });
    if (devis[piece].note) {
      output += `<i>Note : ${devis[piece].note}</i><br>`;
    }
    output += `<br>`;
  }
  document.getElementById("summaryContent").innerHTML = output;
  showPage("summaryPage");
}

</script>

<!-- Pages -->
<div id="homePage" class="page">
  <h2>Choisir une pi√®ce</h2>
  <button class="btn" onclick="selectPiece('Cuisine')">Cuisine</button>
  <button class="btn" onclick="selectPiece('Chambre')">Chambre</button>
  <button class="btn" onclick="selectPiece('Salle de bain')">Salle de bain</button>
  <button class="btn" onclick="selectPiece('Salle d\'eau')">Salle d'eau</button>
  <button class="btn" onclick="selectPiece('Garage')">Garage</button>
  <button class="btn" onclick="selectPiece('Couloir')">Couloir</button>
  <button class="btn" onclick="selectPiece('D√©barras')">D√©barras</button>
  <button class="btn" onclick="selectPiece('Salon')">Salon</button>
  <button class="btn" onclick="selectPiece('Salle √† manger')">Salle √† manger</button>
  <button class="btn" onclick="selectPiece('Ext√©rieur')">Ext√©rieur</button>
  <button class="btn" onclick="selectPiece('Grenier / Combles')">Grenier / Combles</button>
  <hr>
  <button class="btn" onclick="viewSummary()">Voir l'estimatif</button>
</div>

<div id="categoryPage" class="page hidden">
  <h2>Choisir une cat√©gorie</h2>
  <button class="btn" onclick="selectCategory('Prise')">Prises</button>
  <button class="btn" onclick="selectCategory('√âclairage')">√âclairage</button>
  <button class="btn back-btn" onclick="showPage('homePage')">Retour</button>
</div>

<div id="interventionPage" class="page hidden">
  <h2>Type d'intervention</h2>
  <button class="btn" onclick="selectIntervention('Cr√©ation')">Cr√©ation</button>
  <button class="btn" onclick="selectIntervention('Rec√¢blage sans remplacement d‚Äôun appareillage')">Rec√¢blage sans remplacement d‚Äôun appareillage</button>
  <button class="btn" onclick="selectIntervention('Rec√¢blage avec remplacement d‚Äôun appareillage')">Rec√¢blage avec remplacement d‚Äôun appareillage</button>
  <button class="btn" onclick="selectIntervention('Remplacement appareillage')">Remplacement appareillage</button>
  <button class="btn" onclick="selectIntervention('Remplacement luminaire')">Remplacement luminaire</button>
  <button class="btn back-btn" onclick="showPage('categoryPage')">Retour</button>
</div>

<div id="posePage" class="page hidden">
  <h2>Type de pose</h2>
  <button class="btn" onclick="selectPose('Encastr√© ma√ßonnerie')">Encastr√© ma√ßonnerie</button>
  <button class="btn" onclick="selectPose('Placo')">Placo</button>
  <button class="btn" onclick="selectPose('Semi-encastr√©')">Semi-encastr√©</button>
  <button class="btn" onclick="selectPose('Sur-mesure')">Sur-mesure</button>
  <button class="btn back-btn" onclick="showPage('interventionPage')">Retour</button>
</div>

<div id="designationPage" class="page hidden">
  <h2>D√©signation</h2>
  <button class="btn" onclick="selectDesignation('Prise')">Prise</button>
  <button class="btn" onclick="selectDesignation('Point de centre')">Point de centre</button>
  <button class="btn" onclick="selectDesignation('Applique')">Applique</button>
  <button class="btn" onclick="selectDesignation('Interrupteur simple')">Interrupteur simple</button>
  <button class="btn" onclick="selectDesignation('Interrupteur double')">Interrupteur double</button>
  <button class="btn back-btn" onclick="showPage('posePage')">Retour</button>
</div>

<div id="quantityPage" class="page hidden">
  <h2>Quantit√©</h2>
  <input type="number" id="qtyInput" min="1" value="1">
  <button class="btn" onclick="addItem(parseInt(document.getElementById('qtyInput').value))">Valider</button>
  <button class="btn back-btn" onclick="showPage('designationPage')">Retour</button>
</div>

<div id="summaryPage" class="page hidden">
  <h2>R√©sum√©</h2>
  <div id="summaryContent"></div>
  <button class="btn back-btn" onclick="showPage('homePage')">Retour</button>
</div>

</body>
</html>
