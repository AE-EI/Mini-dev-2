<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>MiniDevis Test avec Prix</title>
<style>
  body { font-family: Arial, sans-serif; padding: 20px; }
  button { display: block; margin: 5px 0; padding: 10px; font-size: 16px; }
</style>
</head>
<body>

<h2 id="title">Choisis une pièce :</h2>
<div id="content"></div>

<script>
let devis = {};
let currentRoom = '';

const prix = {
  "Prises - Encastree maconnerie": 120,
  "Prises - Apparent": 100,
  "Point lumineux - Encastree maconnerie": 80,
  "Point lumineux - Apparent": 70,
  "Interrupteur simple - Encastree maconnerie": 40,
  "Interrupteur simple - Apparent": 30,
  "Interrupteur double - Encastree maconnerie": 50,
  "Interrupteur double - Apparent": 40
};

function showRooms() {
  document.getElementById('title').textContent = "Choisis une pièce :";
  document.getElementById('content').innerHTML = '';
  ['Cuisine','Chambre'].forEach(room => {
    let btn = document.createElement('button');
    btn.textContent = room;
    btn.onclick = () => { currentRoom = room; devis[currentRoom] = []; showTypes(); };
    document.getElementById('content').appendChild(btn);
  });
}

function showTypes() {
  document.getElementById('title').textContent = `Que veux-tu ajouter dans ${currentRoom} ?`;
  document.getElementById('content').innerHTML = '';
  ['Prises','Éclairage'].forEach(type => {
    let btn = document.createElement('button');
    btn.textContent = type;
    btn.onclick = () => { currentType = type; showPose(type); };
    document.getElementById('content').appendChild(btn);
  });
}

function showPose(type) {
  document.getElementById('title').textContent = `Type de pose pour ${type} :`;
  document.getElementById('content').innerHTML = '';
  let poses = ['Encastree maconnerie','Apparent'];
  poses.forEach(pose => {
    let btn = document.createElement('button');
    btn.textContent = pose;
    btn.onclick = () => askQuantity(type, pose);
    document.getElementById('content').appendChild(btn);
  });
}

function askQuantity(type, pose) {
  if (type === 'Prises') {
    let q = prompt(`Combien de prises (${pose}) ?`);
    if (!q) return showRooms();
    devis[currentRoom].push(`${q} prises 2p+T - ${pose} (${prix[`Prises - ${pose}`]}€/u)`);
  }
  if (type === 'Éclairage') {
    let pts = prompt("Nombre de points lumineux ?");
    if (pts) devis[currentRoom].push(`${pts} point lumineux - ${pose} (${prix[`Point lumineux - ${pose}`]}€/u)`);
    let intS = prompt("Nombre d'interrupteurs simples ?");
    if (intS) devis[currentRoom].push(`${intS} interrupteur simple - ${pose} (${prix[`Interrupteur simple - ${pose}`]}€/u)`);
    let intD = prompt("Nombre d'interrupteurs doubles ?");
    if (intD) devis[currentRoom].push(`${intD} interrupteur double - ${pose} (${prix[`Interrupteur double - ${pose}`]}€/u)`);
  }
  askNote();
}

function askNote() {
  let note = prompt("Ajouter une note ? (laisser vide pour passer)");
  if (note) devis[currentRoom].push(`Note : ${note}`);
  showSummary();
}

function showSummary() {
  document.getElementById('title').textContent = "Résumé du devis :";
  let html = '<pre>';
  for (let room in devis) {
    html += room + ":\n";
    devis[room].forEach(item => html += "- " + item + "\n");
    html += "\n";
  }
  html += '</pre><button onclick="showRooms()">Ajouter autre chose</button>';
  document.getElementById('content').innerHTML = html;
}

showRooms();
</script>

</body>
</html>
